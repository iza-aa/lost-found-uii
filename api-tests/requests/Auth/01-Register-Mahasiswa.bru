meta {
  name: TC-AUTH-001 Register MAHASISWA
  type: http
  seq: 1
}

post {
  url: {{base_url}}/api/{{api_version}}/auth/register
  body: json
  auth: none
}

body:json {
  {
    "name": "Wildan Ahmad",
    "email": "21523120@students.uii.ac.id",
    "password": "makanbang354",
    "phone": "082334163783",
    "identity_number": "21523120",
    "role": "MAHASISWA",
    "faculty": "Fakultas Teknologi Industri"
  }
}

tests {
  test("Status is 200", function() {
    expect(res.status).to.equal(200);
  });
  
  test("Returns token", function() {
    expect(res.body.token).to.be.a('string');
    expect(res.body.refresh_token).to.be.a('string');
  });
  
  // Save for later use
  if (res.body.token) {
    bru.setEnvVar("token", res.body.token);
    bru.setEnvVar("refresh_token", res.body.refresh_token);
    bru.setEnvVar("user_id", res.body.user.id);
  }
}

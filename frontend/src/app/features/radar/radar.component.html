<div class="fixed inset-0 top-16 bottom-16 md:bottom-0 overflow-hidden">
  <!-- Loading State -->
  @if (isLoading()) {
    <div class="absolute inset-0 flex items-center justify-center bg-gray-100 dark:bg-gray-900 z-10">
      <div class="text-center">
        <app-cube-loader></app-cube-loader>
        <p class="text-gray-500 dark:text-gray-400 mt-6">Memuat peta...</p>
      </div>
    </div>
  }

  <!-- Map Container -->
  <div id="radar-map" class="w-full h-full"></div>

  <!-- Top Bar - Filter & Stats -->
  <div class="absolute top-4 left-4 right-4 z-[400] flex flex-col sm:flex-row items-start sm:items-center justify-between gap-3">
    <!-- Filter Buttons -->
    <div class="bg-white dark:bg-gray-800 rounded-xl shadow-lg p-1.5 flex gap-1">
      <button 
        (click)="setFilter('all')"
        [class]="selectedFilter() === 'all' 
          ? 'px-4 py-2 rounded-lg text-sm font-medium bg-uii-blue text-white' 
          : 'px-4 py-2 rounded-lg text-sm font-medium text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700'">
        Semua
      </button>
      <button 
        (click)="setFilter('lost')"
        [class]="selectedFilter() === 'lost' 
          ? 'px-4 py-2 rounded-lg text-sm font-medium bg-red-500 text-white' 
          : 'px-4 py-2 rounded-lg text-sm font-medium text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700'">
        <i class="ph ph-question mr-1"></i>
        Hilang
      </button>
      <button 
        (click)="setFilter('found')"
        [class]="selectedFilter() === 'found' 
          ? 'px-4 py-2 rounded-lg text-sm font-medium bg-green-500 text-white' 
          : 'px-4 py-2 rounded-lg text-sm font-medium text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700'">
        <i class="ph ph-check mr-1"></i>
        Ditemukan
      </button>
    </div>

    <!-- Stats -->
    <div class="bg-white dark:bg-gray-800 rounded-xl shadow-lg px-4 py-2 flex items-center gap-4 text-sm">
      <div class="flex items-center gap-2">
        <span class="w-3 h-3 rounded-full bg-red-500"></span>
        <span class="text-gray-700 dark:text-gray-300">{{ lostCount() }} Hilang</span>
      </div>
      <div class="flex items-center gap-2">
        <span class="w-3 h-3 rounded-full bg-green-500"></span>
        <span class="text-gray-700 dark:text-gray-300">{{ foundCount() }} Ditemukan</span>
      </div>
    </div>
  </div>

  <!-- Map Controls -->
  <div class="absolute bottom-24 md:bottom-8 right-4 z-[400] flex flex-col gap-2">
    <!-- Center Map Button -->
    <button 
      (click)="centerMap()"
      class="w-12 h-12 bg-white dark:bg-gray-800 rounded-xl shadow-lg flex items-center justify-center text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700 transition"
      title="Kembali ke Kampus UII">
      <i class="ph ph-crosshair text-xl"></i>
    </button>

    <!-- Locate Me Button -->
    <button 
      (click)="locateMe()"
      class="w-12 h-12 bg-uii-blue rounded-xl shadow-lg flex items-center justify-center text-white hover:bg-uii-blue/90 transition"
      title="Lokasi Saya">
      <i class="ph ph-navigation-arrow text-xl"></i>
    </button>
  </div>

  <!-- Legend (Mobile) -->
  <div class="absolute bottom-24 left-4 z-[400] md:hidden">
    <div class="bg-white dark:bg-gray-800 rounded-xl shadow-lg p-3">
      <p class="text-xs text-gray-500 dark:text-gray-400 mb-2 font-medium">Keterangan:</p>
      <div class="flex flex-col gap-1.5 text-xs">
        <div class="flex items-center gap-2">
          <div class="w-6 h-6 rounded-full bg-red-500 flex items-center justify-center">
            <i class="ph ph-question text-white text-xs"></i>
          </div>
          <span class="text-gray-600 dark:text-gray-400">Barang Hilang</span>
        </div>
        <div class="flex items-center gap-2">
          <div class="w-6 h-6 rounded-full bg-green-500 flex items-center justify-center">
            <i class="ph ph-check text-white text-xs"></i>
          </div>
          <span class="text-gray-600 dark:text-gray-400">Barang Ditemukan</span>
        </div>
      </div>
    </div>
  </div>
</div>
